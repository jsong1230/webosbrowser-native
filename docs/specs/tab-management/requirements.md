# 탭 관리 시스템 — 요구사항 분석서

## 1. 개요

### 기능명
탭 관리 시스템 (Tab Management System)

### 목적
여러 웹 페이지를 동시에 열어두고 효율적으로 전환할 수 있는 다중 탭 브라우징 환경을 제공하여 사용자의 웹 서핑 편의성을 극대화합니다.

### 대상 사용자
LG 프로젝터 HU175QW를 사용하여 대화면에서 웹 브라우저를 이용하는 가정용 엔터테인먼트 사용자. 리모컨으로 YouTube, Netflix 등 여러 스트리밍 서비스와 웹사이트를 전환하며 탐색하는 시나리오를 주요 사용 사례로 합니다.

### 요청 배경
현재 구현된 WebView 컴포넌트는 단일 탭만 지원하며, 사용자가 여러 웹사이트를 동시에 열어두고 전환해야 하는 멀티태스킹 요구사항을 충족하지 못합니다. 데스크톱/모바일 브라우저와 같은 탭 기반 인터페이스를 webOS 리모컨 환경에 최적화하여 제공할 필요가 있습니다.

### 의존성
- **F-02 (WebView 통합)**: 탭별로 독립적인 WebView 인스턴스를 관리하기 위해 WebView 컴포넌트 구조를 확장합니다.
- **F-04 (NavigationBar)**: 탭 전환 시 각 탭의 히스토리 스택 정보를 연동하여 뒤로/앞으로 버튼 상태를 업데이트합니다.
- **F-05 (LoadingBar)**: 탭 전환 시에도 로딩 인디케이터가 올바르게 표시되도록 연동합니다.

---

## 2. 기능 요구사항 (Functional Requirements)

### FR-1: 탭 생성 (New Tab)
- **설명**: 사용자가 새 탭을 추가하여 독립적인 웹 페이지 탐색 환경을 생성할 수 있습니다.
- **유저 스토리**:
  - As a 프로젝터 브라우저 사용자,
  - I want 새 탭을 쉽게 추가할 수 있도록,
  - So that 현재 보던 페이지를 유지한 채 다른 웹사이트를 열 수 있다.
- **세부 기능**:
  - TabBar에 "+" 버튼 제공 (리모컨으로 포커스 및 선택 가능)
  - 새 탭 생성 시 기본 URL(홈페이지)로 초기화
  - 최대 5개 탭까지 생성 가능 (메모리 제약)
  - 5개 초과 시 경고 메시지 표시 (더 이상 탭을 추가할 수 없음)
- **우선순위**: Must

### FR-2: 탭 전환 (Switch Tab)
- **설명**: 생성된 탭 간에 빠르게 전환하여 각 탭의 웹 페이지를 확인할 수 있습니다.
- **유저 스토리**:
  - As a 프로젝터 브라우저 사용자,
  - I want 리모컨 방향키로 탭을 전환할 수 있도록,
  - So that 마우스 없이도 편리하게 여러 페이지 간 이동할 수 있다.
- **세부 기능**:
  - TabBar에 탭 목록 표시 (탭 제목 또는 URL)
  - 리모컨 좌/우 방향키로 탭 포커스 이동
  - 선택 버튼 클릭 시 해당 탭으로 전환
  - 현재 활성 탭은 시각적으로 강조 표시 (배경색 또는 테두리)
  - 탭 전환 시 WebView 인스턴스 교체 (메모리 최적화)
- **우선순위**: Must

### FR-3: 탭 닫기 (Close Tab)
- **설명**: 더 이상 사용하지 않는 탭을 닫아 메모리를 확보합니다.
- **유저 스토리**:
  - As a 프로젝터 브라우저 사용자,
  - I want 사용하지 않는 탭을 닫을 수 있도록,
  - So that 불필요한 페이지를 제거하고 메모리를 절약할 수 있다.
- **세부 기능**:
  - 각 탭에 "X" 닫기 버튼 제공 (리모컨 포커스 가능)
  - 닫기 버튼 클릭 시 해당 탭 삭제
  - 마지막 탭은 닫을 수 없음 (최소 1개 탭 유지)
  - 탭 닫기 시 WebView 인스턴스 메모리 해제
  - 현재 활성 탭을 닫을 경우 이전 탭으로 자동 전환
- **우선순위**: Must

### FR-4: 탭 상태 유지 (Tab State Persistence)
- **설명**: 각 탭의 URL, 히스토리 스택, 로딩 상태를 독립적으로 관리합니다.
- **유저 스토리**:
  - As a 프로젝터 브라우저 사용자,
  - I want 탭을 전환해도 각 탭의 페이지 상태가 유지되도록,
  - So that 이전 탭으로 돌아왔을 때 처음부터 다시 로딩할 필요가 없다.
- **세부 기능**:
  - 각 탭은 독립적인 데이터 구조를 가짐 (TabModel)
  - 탭별 정보: ID, URL, 제목, 히스토리 스택, 히스토리 인덱스, 로딩 상태
  - 탭 전환 시 이전 탭의 WebView 인스턴스를 DOM에서 제거 (메모리 최적화)
  - 탭 전환 시 새 탭의 상태 정보를 WebView와 NavigationBar에 반영
- **우선순위**: Must

### FR-5: TabBar UI 컴포넌트
- **설명**: 탭 목록과 컨트롤을 표시하는 시각적 인터페이스를 제공합니다.
- **유저 스토리**:
  - As a 프로젝터 브라우저 사용자,
  - I want 대화면에서도 탭 목록을 쉽게 식별할 수 있도록,
  - So that 어떤 탭이 활성 상태인지 직관적으로 알 수 있다.
- **세부 기능**:
  - 탭 리스트: 탭 제목 또는 URL 표시 (최대 30자, 초과 시 "...")
  - 현재 활성 탭 강조 (배경색 변경)
  - "+ 새 탭" 버튼
  - 각 탭의 닫기 버튼 (X)
  - Enact Spotlight 통합 (리모컨 포커스 관리)
  - 최소 폰트 크기 24px (대화면 가독성)
- **우선순위**: Must

### FR-6: TabManager 서비스
- **설명**: 탭 배열의 CRUD(생성/조회/수정/삭제) 로직을 중앙 집중화합니다.
- **유저 스토리**:
  - As a 개발자,
  - I want 탭 관리 로직을 재사용 가능한 서비스로 분리하여,
  - So that 컴포넌트 코드를 단순하게 유지하고 테스트하기 쉽도록 한다.
- **세부 기능**:
  - `createTab(url)`: 새 탭 생성, 고유 ID 할당
  - `getTab(id)`: 특정 탭 조회
  - `getAllTabs()`: 모든 탭 조회
  - `updateTab(id, updates)`: 탭 정보 업데이트 (URL, 제목, 히스토리 스택 등)
  - `closeTab(id)`: 탭 삭제 (최소 1개 유지)
  - `switchTab(id)`: 활성 탭 변경
  - `getActiveTab()`: 현재 활성 탭 반환
  - 탭 배열은 메모리에만 저장 (영속성 불필요, 앱 재시작 시 초기화)
- **우선순위**: Must

### FR-7: 리모컨 단축키 연동 (F-13 의존)
- **설명**: 리모컨 채널 버튼으로 탭 간 빠른 전환을 지원합니다.
- **유저 스토리**:
  - As a 프로젝터 브라우저 사용자,
  - I want 리모컨 채널 버튼으로 탭을 전환할 수 있도록,
  - So that UI를 조작하지 않고도 빠르게 탭을 이동할 수 있다.
- **세부 기능**:
  - 채널 업 버튼 → 다음 탭으로 전환
  - 채널 다운 버튼 → 이전 탭으로 전환
  - 탭이 1개만 있을 때는 단축키 무시
- **우선순위**: Should (F-13에서 구현)

---

## 3. 비기능 요구사항 (Non-Functional Requirements)

### NFR-1: 성능
- **탭 전환 속도**: 탭 전환 시 0.5초 이내 UI 반응 (WebView 인스턴스 교체 시간 포함)
- **메모리 최적화**: 백그라운드 탭의 WebView 인스턴스는 DOM에서 제거하되, 탭 정보(URL, 히스토리)는 메모리에 유지
- **최대 탭 수 제한**: 5개 (프로젝터 하드웨어 메모리 제약 고려)
- **페이지 로딩**: 각 탭의 페이지 로딩은 3초 이내 (F-02 요구사항 준수)

### NFR-2: UX
- **리모컨 최적화**: 5-way 방향키 + 선택 버튼으로 모든 탭 관리 기능 접근 가능
- **대화면 가독성**: TabBar 최소 폰트 크기 24px, 고대비 색상 사용
- **시각적 피드백**: 현재 활성 탭 강조 표시, 포커스 상태 명확한 테두리
- **직관적 UI**: 탭 순서는 생성 순서대로 나열, 좌에서 우로 배치

### NFR-3: 확장성
- **플러그인 아키텍처**: TabManager 서비스는 향후 탭 그룹, 탭 저장 기능 추가 가능하도록 설계
- **상태 관리**: Context API 또는 useReducer로 탭 상태를 전역 관리하여 컴포넌트 간 데이터 동기화 용이

### NFR-4: 보안
- **탭 격리**: 각 탭의 WebView는 독립적인 sandbox 설정을 유지 (F-02 요구사항 준수)
- **메모리 누수 방지**: 탭 닫기 시 iframe src를 'about:blank'로 설정하여 리소스 해제

---

## 4. 데이터 구조

### 4.1 TabModel (탭 데이터 모델)

```javascript
{
  id: String,               // 고유 ID (UUID 또는 타임스탬프)
  url: String,              // 현재 URL
  title: String,            // 페이지 제목 (기본값: URL)
  favicon: String,          // 파비콘 URL (선택, F-15에서 활용)
  historyStack: [String],   // 히스토리 스택 (URL 배열)
  historyIndex: Number,     // 현재 히스토리 인덱스
  isLoading: Boolean,       // 로딩 상태
  isError: Boolean,         // 에러 상태
  createdAt: Date,          // 생성 시간
  lastAccessedAt: Date      // 마지막 접근 시간
}
```

### 4.2 TabManager State

```javascript
{
  tabs: [TabModel],         // 탭 배열
  activeTabId: String       // 현재 활성 탭 ID
}
```

---

## 5. 제약조건

### 5.1 하드웨어 제약
- **최대 탭 수**: 5개 (프로젝터 메모리 제약)
- **CPU 성능**: 탭 전환 시 CPU 사용률 고려, 백그라운드 탭은 DOM에서 제거하여 렌더링 부하 최소화

### 5.2 webOS 플랫폼 제약
- **WebView 리소스**: iframe 기반 WebView는 브라우저 프로세스 리소스를 공유하므로 탭 수 증가 시 성능 저하 가능
- **Spotlight 포커스 관리**: TabBar와 다른 UI 영역(URLBar, NavigationBar) 간 포커스 전환 흐름을 명확히 설계 필요

### 5.3 UX 제약
- **리모컨 입력**: 마우스/터치 입력 없이 리모컨만으로 탭 관리 가능해야 함
- **대화면 거리**: 사용자는 2~3m 거리에서 화면을 보므로 UI 요소 크기와 간격을 충분히 확보

### 5.4 기술 제약
- **탭 영속성 없음**: 앱 재시작 시 탭 목록은 초기화됨 (영속 저장소 미사용)
- **iframe 제약**: 외부 사이트의 CORS 정책으로 일부 탭 정보(제목, favicon) 추출 불가능할 수 있음

---

## 6. 용어 정의

| 용어 | 정의 |
|------|------|
| 탭 (Tab) | 독립적인 웹 페이지 탐색 환경을 가진 단위. 각 탭은 고유한 URL, 히스토리 스택, 로딩 상태를 가짐 |
| 활성 탭 (Active Tab) | 현재 사용자에게 표시되고 있는 탭. 한 번에 1개의 탭만 활성 상태 |
| 백그라운드 탭 (Background Tab) | 생성되어 있지만 현재 표시되지 않는 탭. DOM에서 제거되어 렌더링 부하 최소화 |
| TabBar | 탭 목록과 컨트롤(새 탭, 닫기)을 표시하는 UI 컴포넌트 |
| TabManager | 탭 CRUD 로직을 처리하는 서비스 계층 |
| 탭 전환 (Tab Switch) | 다른 탭을 활성 탭으로 변경하는 동작 |
| 히스토리 스택 (History Stack) | 각 탭 내에서 방문한 페이지의 URL 목록 (뒤로/앞으로 기능 지원) |

---

## 7. 범위 외 (Out of Scope)

### 이번 기능에서 하지 않는 것
- **탭 영속성**: 앱 재시작 시 탭 목록 복원 (F-11 설정 기능에서 선택적으로 추가 검토)
- **탭 그룹**: 탭을 폴더/그룹으로 묶는 기능 (향후 확장)
- **탭 미리보기**: 탭 전환 시 썸네일 이미지 표시 (하드웨어 성능 제약)
- **탭 고정 (Pin Tab)**: 특정 탭을 고정하여 닫히지 않도록 하는 기능
- **탭 순서 변경**: 탭 목록에서 탭의 위치를 드래그 앤 드롭으로 변경 (리모컨 UX에 부적합)
- **시크릿 모드**: 개별 탭에 대한 프라이빗 브라우징 모드 (전역 설정으로만 지원)

---

## 8. 완료 기준 (Definition of Done)

### 8.1 기능 완료
- [ ] 새 탭 생성 버튼 클릭 시 새 탭이 추가되고 활성화됨
- [ ] 최대 5개 탭까지 생성 가능, 초과 시 경고 메시지 표시
- [ ] 탭 전환 시 WebView가 해당 탭의 URL로 업데이트됨
- [ ] 탭 닫기 버튼 클릭 시 해당 탭이 삭제되고 이전 탭으로 전환됨
- [ ] 마지막 탭은 닫을 수 없음 (최소 1개 유지)
- [ ] 각 탭의 히스토리 스택이 독립적으로 관리됨 (canGoBack, canGoForward 정확히 반영)
- [ ] TabBar에 탭 목록이 표시되고, 현재 활성 탭이 시각적으로 강조됨

### 8.2 성능 완료
- [ ] 탭 전환 시 0.5초 이내 UI 반응
- [ ] 탭 5개 생성 시에도 브라우저 성능 저하 없음
- [ ] 백그라운드 탭의 WebView는 DOM에서 제거되어 메모리 절약

### 8.3 UX 완료
- [ ] 리모컨 좌/우 방향키로 TabBar의 탭 간 포커스 이동
- [ ] 리모컨 선택 버튼으로 탭 전환 가능
- [ ] 리모컨 포커스 상태가 명확히 표시됨 (테두리, 배경색)
- [ ] 대화면에서 TabBar 텍스트가 가독성 있게 표시됨 (최소 24px)

### 8.4 통합 완료
- [ ] NavigationBar의 뒤로/앞으로 버튼이 탭 전환 시 올바른 상태로 업데이트됨
- [ ] LoadingBar가 탭 전환 시에도 올바르게 표시됨
- [ ] 히스토리 서비스(F-08)가 각 탭의 방문 기록을 정확히 저장함

### 8.5 코드 품질 완료
- [ ] TabManager 서비스 단위 테스트 통과
- [ ] TabBar 컴포넌트 렌더링 테스트 통과
- [ ] ESLint 규칙 통과 (세미콜론 없음, 탭 들여쓰기)
- [ ] PropTypes 타입 검증 추가
- [ ] 코드 리뷰 승인

### 8.6 문서 완료
- [ ] 컴포넌트 문서 작성 (`docs/components/TabBar.md`, `docs/components/TabManager.md`)
- [ ] CHANGELOG 업데이트
- [ ] dev-log 업데이트
