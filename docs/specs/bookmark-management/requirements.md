# 북마크 관리 — 요구사항 분석서

## 1. 개요

### 기능명
북마크 관리 (F-07)

### 목적
사용자가 자주 방문하는 웹사이트를 북마크로 저장하고 관리할 수 있는 기능을 제공하여, 리모컨만으로도 빠르고 편리하게 저장된 사이트에 접근할 수 있도록 합니다.

### 대상 사용자
- 자주 방문하는 웹사이트(YouTube, Netflix, 뉴스 사이트 등)를 빠르게 재방문하고자 하는 프로젝터 사용자
- 리모컨으로 URL을 반복 입력하는 불편함을 줄이고자 하는 일반 사용자
- 북마크를 폴더별로 체계적으로 관리하고자 하는 조직적인 사용자

### 요청 배경
- 리모컨 가상 키보드로 URL을 입력하는 것은 시간이 오래 걸리고 불편함
- 자주 방문하는 사이트를 북마크로 저장하면 2~3번의 버튼 클릭만으로 접근 가능
- 북마크는 웹 브라우저의 핵심 기능으로, 사용자 경험 향상에 필수적
- 대화면 환경에서 북마크 목록을 탐색하고 관리하기 위한 리모컨 최적화 UI 필요

---

## 2. 기능 요구사항 (Functional Requirements)

### FR-1: 북마크 추가
- **설명**: 현재 페이지를 북마크로 저장합니다.
- **유저 스토리**: As a 사용자, I want 현재 보고 있는 페이지를 북마크로 저장할 수 있기를 원합니다, so that 나중에 빠르게 재방문할 수 있습니다.
- **우선순위**: Must
- **상세 요구사항**:
  - 북마크 추가 버튼 (NavigationBar 또는 URLBar에 위치)
  - 버튼 클릭 시 북마크 추가 다이얼로그 표시
  - 다이얼로그 입력 항목:
    - **제목**: 현재 페이지 타이틀 자동 입력, 사용자 편집 가능
    - **URL**: 현재 페이지 URL (편집 불가 또는 읽기 전용)
    - **폴더 선택**: 저장할 폴더 선택 (기본: 루트 폴더)
    - **설명** (선택): 북마크 설명 메모 (선택적 기능)
  - 확인 버튼으로 저장, 취소 버튼으로 닫기
  - 저장 성공 시 토스트 메시지 표시 ("북마크가 저장되었습니다")
  - 이미 북마크된 페이지일 경우 "이미 북마크에 추가된 페이지입니다" 메시지 표시

### FR-2: 북마크 목록 조회
- **설명**: 저장된 북마크를 리스트 형태로 조회합니다.
- **유저 스토리**: As a 사용자, I want 저장된 북마크 목록을 탐색할 수 있기를 원합니다, so that 원하는 사이트를 찾아 접근할 수 있습니다.
- **우선순위**: Must
- **상세 요구사항**:
  - BookmarkPanel 컴포넌트 (북마크 목록 화면)
  - 북마크 메뉴 버튼으로 패널 열기 (NavigationBar 또는 리모컨 단축키)
  - 북마크 리스트 표시:
    - 각 항목: 파비콘 (선택), 제목, URL (서브 텍스트)
    - 폴더 구조 트리 뷰 또는 계층형 리스트
    - 리모컨 방향키 상/하로 목록 스크롤
  - 포커스된 북마크 하이라이트 표시 (두꺼운 테두리 또는 배경색)
  - 빈 북마크 목록일 경우 "저장된 북마크가 없습니다" 메시지 표시
  - 백 버튼으로 패널 닫기

### FR-3: 북마크 실행 (페이지 열기)
- **설명**: 북마크 목록에서 북마크를 선택하면 해당 페이지를 WebView에서 로드합니다.
- **유저 스토리**: As a 사용자, I want 북마크를 선택하면 해당 페이지가 즉시 열리기를 원합니다, so that URL을 다시 입력하지 않아도 됩니다.
- **우선순위**: Must
- **상세 요구사항**:
  - 북마크 항목에서 선택 버튼 클릭 시 해당 URL로 페이지 로드
  - 새 탭에서 열기 옵션 제공 (컨텍스트 메뉴 또는 추가 버튼)
  - 로드 시작 시 로딩 인디케이터 표시 (F-05와 연계)
  - 로드 성공 시 BookmarkPanel 자동 닫기 (설정 가능)
  - 로드 실패 시 에러 메시지 표시 (F-10과 연계)

### FR-4: 북마크 편집
- **설명**: 기존 북마크의 제목, URL, 폴더를 수정합니다.
- **유저 스토리**: As a 사용자, I want 북마크의 제목이나 위치를 변경할 수 있기를 원합니다, so that 북마크를 더 체계적으로 관리할 수 있습니다.
- **우선순위**: Must
- **상세 요구사항**:
  - 북마크 항목에서 편집 버튼 또는 컨텍스트 메뉴 (리모컨 옵션 버튼)
  - 북마크 편집 다이얼로그 표시:
    - 제목, URL, 폴더 선택 (FR-1과 동일한 UI)
    - 기존 값 자동 입력됨
  - 확인 버튼으로 저장, 취소 버튼으로 닫기
  - 저장 성공 시 토스트 메시지 ("북마크가 수정되었습니다")
  - URL 변경 시 유효성 검증 (URL 형식 체크)

### FR-5: 북마크 삭제
- **설명**: 북마크 목록에서 선택한 북마크를 삭제합니다.
- **유저 스토리**: As a 사용자, I want 더 이상 필요하지 않은 북마크를 삭제할 수 있기를 원합니다, so that 북마크 목록을 깔끔하게 유지할 수 있습니다.
- **우선순위**: Must
- **상세 요구사항**:
  - 북마크 항목에서 삭제 버튼 또는 컨텍스트 메뉴
  - 삭제 확인 다이얼로그 표시 ("북마크를 삭제하시겠습니까?")
  - 확인 버튼으로 삭제, 취소 버튼으로 닫기
  - 삭제 성공 시 목록에서 즉시 제거, 토스트 메시지 표시 ("북마크가 삭제되었습니다")
  - 삭제 후 포커스는 이전 항목 또는 다음 항목으로 이동

### FR-6: 폴더 관리 (생성, 이름 변경, 삭제)
- **설명**: 북마크를 폴더별로 분류하여 관리합니다.
- **유저 스토리**: As a 사용자, I want 북마크를 폴더로 구분하여 저장할 수 있기를 원합니다, so that 카테고리별로 북마크를 정리할 수 있습니다.
- **우선순위**: Should
- **상세 요구사항**:
  - **폴더 생성**:
    - "새 폴더" 버튼 (BookmarkPanel 상단)
    - 폴더 생성 다이얼로그: 폴더 이름 입력
    - 폴더는 루트 또는 다른 폴더 내에 생성 가능 (1단계 서브폴더만 지원)
  - **폴더 이름 변경**:
    - 폴더 항목에서 편집 버튼 또는 컨텍스트 메뉴
    - 폴더 이름 편집 다이얼로그
  - **폴더 삭제**:
    - 폴더 항목에서 삭제 버튼 또는 컨텍스트 메뉴
    - 폴더 내 북마크가 있을 경우 경고 메시지 ("폴더 내 북마크도 삭제됩니다")
    - 확인 시 폴더 및 하위 북마크 모두 삭제
  - **폴더 구조**:
    - 루트 폴더 (기본 위치)
    - 서브폴더 (최대 1단계 깊이, 예: 루트 > 엔터테인먼트 > YouTube)
    - 폴더 항목은 북마크 목록에서 아이콘으로 구분 (폴더 아이콘 vs 북마크 아이콘)
  - **폴더 탐색**:
    - 폴더 선택 시 해당 폴더 내 북마크 표시
    - 백 버튼으로 상위 폴더로 이동

### FR-7: 북마크 정렬 및 검색
- **설명**: 북마크 목록을 정렬하거나 검색하여 원하는 북마크를 빠르게 찾습니다.
- **유저 스토리**: As a 사용자, I want 북마크 목록에서 빠르게 원하는 북마크를 찾을 수 있기를 원합니다, so that 많은 북마크 중에서도 쉽게 탐색할 수 있습니다.
- **우선순위**: Could (선택적 기능)
- **상세 요구사항**:
  - **정렬 옵션**:
    - 이름순 (A-Z)
    - 추가된 날짜순 (최신순/오래된순)
    - 방문 빈도순 (가장 많이 방문한 북마크 우선)
  - **검색 기능**:
    - BookmarkPanel 상단에 검색 입력 필드
    - 리모컨 가상 키보드로 검색어 입력
    - 제목 또는 URL에서 일치하는 북마크 필터링
    - 검색 결과 실시간 업데이트

### FR-8: 북마크 데이터 영속성 (IndexedDB 저장)
- **설명**: 북마크 데이터를 IndexedDB에 저장하여 앱 재시작 후에도 유지됩니다.
- **유저 스토리**: As a 사용자, I want 저장한 북마크가 앱을 종료해도 사라지지 않기를 원합니다, so that 다음에 앱을 실행할 때도 북마크를 사용할 수 있습니다.
- **우선순위**: Must
- **상세 요구사항**:
  - BookmarkManager 서비스: IndexedDB를 사용한 CRUD 작업
  - 북마크 데이터 구조:
    ```javascript
    {
      id: "unique-id", // UUID 또는 auto-increment ID
      title: "YouTube",
      url: "https://www.youtube.com",
      folderId: "folder-id" or null, // 루트 폴더는 null
      favicon: "https://www.youtube.com/favicon.ico", // 선택적
      createdAt: 1620000000000, // Unix timestamp
      updatedAt: 1620000000000,
      visitCount: 5 // 방문 횟수 (선택적)
    }
    ```
  - 폴더 데이터 구조:
    ```javascript
    {
      id: "folder-id",
      name: "엔터테인먼트",
      parentId: null or "parent-folder-id",
      createdAt: 1620000000000
    }
    ```
  - IndexedDB 스키마:
    - `bookmarks` 오브젝트 스토어 (키: `id`, 인덱스: `folderId`, `title`, `createdAt`)
    - `folders` 오브젝트 스토어 (키: `id`, 인덱스: `parentId`, `name`)
  - 앱 초기화 시 북마크 및 폴더 데이터 로드

### FR-9: 리모컨 키 매핑
- **설명**: webOS 리모컨 물리 버튼을 북마크 기능에 매핑합니다.
- **유저 스토리**: As a 리모컨 사용자, I want 리모컨 버튼만으로 북마크 관리의 모든 기능을 사용할 수 있기를 원합니다, so that 마우스 없이 편리하게 북마크를 관리할 수 있습니다.
- **우선순위**: Must
- **상세 요구사항**:
  - 방향키 상/하: 북마크 목록 스크롤, 폴더 탐색
  - 방향키 좌: 상위 폴더로 이동
  - 방향키 우: 폴더 열기 (서브폴더 표시)
  - 선택 버튼: 북마크 실행 (페이지 열기), 폴더 열기
  - 백 버튼: BookmarkPanel 닫기, 상위 폴더로 이동
  - 컬러 버튼 (선택):
    - 빨강: 북마크 추가 (현재 페이지)
    - 파랑: 북마크 편집
    - 노랑: 북마크 삭제
    - 초록: 새 폴더 생성
  - 옵션 버튼: 컨텍스트 메뉴 열기 (편집, 삭제, 새 탭에서 열기)

---

## 3. 비기능 요구사항 (Non-Functional Requirements)

### 성능
- **북마크 로딩 시간**: 앱 시작 시 IndexedDB에서 북마크 데이터 로드 1초 이내
- **북마크 추가/편집/삭제 반응 속도**: 사용자 동작 후 0.5초 이내에 UI 업데이트
- **목록 스크롤 성능**: 북마크 100개 이상일 때도 스크롤 버벅임 없이 부드럽게 동작
- **메모리 사용량**: 북마크 데이터 및 UI는 최대 100MB 이하

### 가독성 (대화면 최적화)
- **폰트 크기**:
  - 북마크 제목: 최소 20px
  - URL 서브 텍스트: 최소 16px
  - 폴더 이름: 최소 22px
- **대비**: 배경과 전경 색상 대비 비율 4.5:1 이상 (WCAG AA 기준)
- **포커스 표시**: 포커스된 북마크 항목은 3px 두께 테두리 또는 명확한 배경색 변화
- **아이콘 크기**: 파비콘, 폴더 아이콘 최소 32x32px

### UX (리모컨 최적화)
- **포커스 경로**: 리모컨 방향키로 모든 북마크, 폴더, 버튼에 접근 가능
- **직관적인 폴더 탐색**: 폴더 구조가 명확하게 시각적으로 표시됨 (트리 뷰 또는 브레드크럼)
- **피드백 제공**: 북마크 추가/편집/삭제 시 토스트 메시지 또는 애니메이션
- **에러 복구**: 삭제 후 "실행 취소" 옵션 제공 (선택적 기능)

### 확장성
- **북마크 동기화**: 향후 LG 계정 연동으로 북마크 클라우드 동기화 가능하도록 서비스 계층 모듈화
- **북마크 가져오기/내보내기**: HTML 북마크 파일 가져오기/내보내기 기능 추가 가능
- **폴더 깊이 확장**: 현재 1단계 서브폴더만 지원하나, 향후 다단계 폴더 구조 지원 가능

### 보안
- **URL 검증**: 북마크 추가/편집 시 유효한 URL 형식인지 검증
- **XSS 방지**: 북마크 제목, URL에 HTML 태그 이스케이프 처리
- **IndexedDB 보안**: 민감한 데이터는 암호화 저장 (선택적, 현재는 URL과 제목만 저장)

---

## 4. 제약조건

### webOS 플랫폼 제약사항
- **리모컨 전용 입력**: 마우스, 터치, 물리 키보드 사용 불가
- **Spotlight 시스템**: Enact의 Spotlight 시스템을 통해 포커스 관리 필수 (Spotlightable 컴포넌트 사용)
- **5-way 방향키**: 상/하/좌/우/선택 버튼만으로 모든 입력 처리
- **화면 해상도**: 4K UHD (3840x2160) 기본, Full HD (1920x1080) 호환

### 기술 제약사항
- **프레임워크**: Enact 프레임워크 기반 (React 컴포넌트)
- **UI 컴포넌트**: Enact Moonstone UI 컴포넌트 우선 사용 (VirtualList, Panels, Dialog 등)
- **CSS Modules**: 스타일링은 `.module.less` 파일로 분리
- **상태 관리**: React Hooks (useState, useReducer, useContext)
- **데이터 저장**: IndexedDB (webOS에서 권장, LocalStorage는 용량 제한)
- **북마크 용량**: IndexedDB 용량 제한 (브라우저별 상이하나, 최소 50MB 이상 보장)

### 의존성
- **F-01 (프로젝트 초기 설정)**: Enact 프로젝트 구조 및 라우팅 설정 완료 필요
- **F-02 (웹뷰 통합)**: 북마크 실행 시 WebView 컴포넌트로 페이지 로드 필요
- **F-03 (URL 입력 UI)**: 북마크 URL 편집 시 가상 키보드 사용 (선택적)

### 범위 외 (Out of Scope)
- **북마크 동기화**: 외부 브라우저 또는 클라우드와 북마크 동기화 미지원 (향후 확장 가능)
- **북마크 가져오기/내보내기**: HTML 북마크 파일 가져오기/내보내기 미지원
- **파비콘 자동 다운로드**: 북마크 추가 시 파비콘 자동 다운로드 미지원 (선택적 기능)
- **북마크 태그**: 북마크에 태그 추가 기능 미지원
- **북마크 공유**: 다른 사용자와 북마크 공유 기능 미지원

---

## 5. 용어 정의

| 용어 | 정의 |
|------|------|
| **북마크** | 사용자가 자주 방문하는 웹 페이지의 URL과 제목을 저장한 항목 |
| **BookmarkPanel** | 북마크 목록을 표시하고 관리하는 UI 패널 컴포넌트 |
| **BookmarkManager** | 북마크 데이터의 CRUD 작업을 담당하는 서비스 계층 |
| **폴더** | 북마크를 카테고리별로 분류하기 위한 디렉토리 구조 |
| **루트 폴더** | 최상위 폴더로, folderId가 null인 북마크가 저장되는 기본 위치 |
| **서브폴더** | 루트 폴더 또는 다른 폴더 내에 생성된 하위 폴더 (1단계 깊이만 지원) |
| **IndexedDB** | 브라우저 내장 NoSQL 데이터베이스로, 대용량 데이터 저장에 적합 |
| **파비콘** | 웹사이트의 작은 아이콘 이미지 (16x16px 또는 32x32px) |
| **컨텍스트 메뉴** | 북마크 항목에서 추가 작업(편집, 삭제 등)을 선택할 수 있는 팝업 메뉴 |
| **토스트 메시지** | 화면 하단에 짧게 표시되는 알림 메시지 (예: "북마크가 저장되었습니다") |

---

## 6. 완료 기준 (Acceptance Criteria)

### AC-1: 북마크 추가
- [ ] 북마크 추가 버튼 클릭 시 북마크 추가 다이얼로그 표시
- [ ] 현재 페이지 타이틀과 URL이 자동 입력됨
- [ ] 폴더 선택 옵션 제공 (기본: 루트 폴더)
- [ ] 확인 버튼으로 저장 시 IndexedDB에 북마크 데이터 저장
- [ ] 저장 후 토스트 메시지 표시 ("북마크가 저장되었습니다")
- [ ] 이미 북마크된 페이지일 경우 중복 알림 표시

### AC-2: 북마크 목록 조회
- [ ] BookmarkPanel 열기 버튼 클릭 시 북마크 목록 패널 표시
- [ ] 저장된 모든 북마크 리스트 형태로 표시 (제목, URL)
- [ ] 폴더 구조 트리 뷰 또는 계층형 리스트 표시
- [ ] 리모컨 방향키로 목록 스크롤 및 탐색 가능
- [ ] 빈 북마크 목록일 경우 안내 메시지 표시
- [ ] 백 버튼으로 패널 닫기

### AC-3: 북마크 실행
- [ ] 북마크 항목 선택 시 해당 URL로 페이지 로드
- [ ] 로드 시작 시 로딩 인디케이터 표시
- [ ] 로드 성공 시 BookmarkPanel 자동 닫기
- [ ] 로드 실패 시 에러 메시지 표시

### AC-4: 북마크 편집
- [ ] 북마크 편집 버튼 또는 컨텍스트 메뉴로 편집 다이얼로그 열기
- [ ] 기존 제목, URL, 폴더 정보 자동 입력
- [ ] 제목, 폴더 변경 가능
- [ ] 확인 버튼으로 저장 시 IndexedDB 업데이트
- [ ] 저장 후 토스트 메시지 표시 ("북마크가 수정되었습니다")

### AC-5: 북마크 삭제
- [ ] 북마크 삭제 버튼 또는 컨텍스트 메뉴로 삭제 확인 다이얼로그 표시
- [ ] 확인 버튼으로 삭제 시 IndexedDB에서 제거
- [ ] 삭제 후 목록에서 즉시 제거, 토스트 메시지 표시
- [ ] 삭제 후 포커스는 이전 또는 다음 항목으로 이동

### AC-6: 폴더 관리
- [ ] 새 폴더 버튼으로 폴더 생성 다이얼로그 열기
- [ ] 폴더 이름 입력 후 생성, IndexedDB에 저장
- [ ] 폴더 편집 버튼으로 폴더 이름 변경 가능
- [ ] 폴더 삭제 시 하위 북마크도 함께 삭제 경고 표시
- [ ] 폴더 항목 선택 시 해당 폴더 내 북마크 표시
- [ ] 백 버튼으로 상위 폴더로 이동

### AC-7: 북마크 정렬 및 검색 (선택적)
- [ ] 정렬 옵션 (이름순, 날짜순, 방문 빈도순) 제공
- [ ] 검색 입력 필드에서 검색어 입력 시 일치하는 북마크 필터링
- [ ] 검색 결과 실시간 업데이트

### AC-8: 데이터 영속성
- [ ] 북마크 추가/편집/삭제 시 IndexedDB에 즉시 반영
- [ ] 앱 재시작 후 저장된 북마크 데이터 정상 로드
- [ ] 앱 초기화 시 1초 이내 북마크 데이터 로드

### AC-9: 리모컨 키 매핑
- [ ] 방향키로 북마크 목록 탐색, 폴더 열기/닫기 가능
- [ ] 선택 버튼으로 북마크 실행, 폴더 열기
- [ ] 백 버튼으로 패널 닫기, 상위 폴더로 이동
- [ ] 컬러 버튼으로 북마크 추가/편집/삭제, 폴더 생성 (선택적)
- [ ] 모든 기능을 마우스 없이 리모컨만으로 사용 가능

### AC-10: 성능 및 가독성
- [ ] 북마크 목록 로딩 시간 1초 이내
- [ ] 북마크 추가/편집/삭제 반응 속도 0.5초 이내
- [ ] 북마크 100개 이상일 때도 스크롤 부드럽게 동작
- [ ] 폰트 크기가 3m 거리에서 가독 가능 (최소 20px)
- [ ] 포커스된 북마크 항목이 명확하게 구분됨

### AC-11: 회귀 테스트
- [ ] 북마크 추가 → 목록에 표시 → 실행 → 페이지 로드 전체 흐름 정상 동작
- [ ] 폴더 생성 → 북마크를 폴더에 추가 → 폴더 내 북마크 조회 정상 동작
- [ ] 북마크 편집 후 변경 사항 목록에 즉시 반영
- [ ] 북마크 삭제 후 목록에서 제거, 재시작 후에도 삭제 유지
- [ ] 앱 재시작 후 모든 북마크 및 폴더 데이터 정상 로드

---

## 7. 참고 사항

### 관련 문서
- PRD: `docs/project/prd.md`
- 기능 백로그: `docs/project/features.md`
- CLAUDE.md: 프로젝트 규칙 및 코딩 컨벤션
- URL 입력 UI 요구사항: `docs/specs/url-input-ui/requirements.md` (자동완성 연동)
- 웹뷰 통합 요구사항: `docs/specs/webview-integration/requirements.md` (페이지 로드 연동)

### 참고 구현
- Enact VirtualList: https://enactjs.com/docs/modules/moonstone/VirtualList/
- Enact Panels: https://enactjs.com/docs/modules/moonstone/Panels/
- Enact Dialog: https://enactjs.com/docs/modules/moonstone/Dialog/
- IndexedDB API: https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API

### 우선순위 조정 가능성
- 폴더 관리 (FR-6)는 Should 우선순위로, 기본 북마크 CRUD 완료 후 추가 가능
- 북마크 정렬 및 검색 (FR-7)은 Could 우선순위로, M3 이후 확장 기능으로 연기 가능
- 파비콘 자동 다운로드는 선택적 기능으로, 기본 기능 완료 후 추가 가능

### 기술적 고려사항
- **IndexedDB vs LocalStorage**: LocalStorage는 용량 제한(5MB)이 있어 북마크 데이터 저장에 부적합하므로 IndexedDB 사용 권장
- **폴더 구조 깊이**: 현재는 1단계 서브폴더만 지원하나, 향후 다단계 폴더 구조로 확장 가능
- **북마크 용량**: 북마크 수천 개 저장 시에도 성능 저하 없도록 인덱스 최적화 필요
- **북마크 중복 방지**: URL 기준으로 중복 체크 (동일 URL은 한 번만 저장)

### 병렬 작업 가능성
- F-07 (북마크 관리), F-08 (히스토리 관리), F-09 (검색 엔진 통합)은 PG-2 병렬 그룹으로 독립적으로 개발 가능
- BookmarkManager 서비스와 BookmarkPanel 컴포넌트는 동일 기능 내에서 순차 개발 권장 (충돌 방지)
