# 다운로드 관리 기능 — 요구사항 분석서

## 1. 개요

### 기능명
다운로드 관리 (Download Management)

### 목적
webOS 브라우저에서 파일 다운로드를 시작하고, 진행 상태를 모니터링하며, 다운로드 이력을 관리할 수 있는 기능을 제공합니다. 프로젝터 환경에서 리모컨만으로 조작 가능한 직관적인 다운로드 UI를 제공하여 사용자가 이미지, 문서, 미디어 파일을 편리하게 다운로드할 수 있습니다.

### 대상 사용자
- **가정용 프로젝터 사용자**: 웹에서 PDF 문서, 이미지, 동영상 파일 등을 다운로드하여 로컬에 저장하고자 하는 사용자
- **엔터테인먼트 소비자**: 스트리밍 콘텐츠의 보조 자료(자막, 포스터 이미지 등)를 다운로드하는 사용자
- **리모컨 전용 사용자**: 마우스나 터치 없이 리모컨 방향키와 선택 버튼만으로 다운로드 관리를 원하는 사용자

### 요청 배경
- 웹 브라우징 중 파일 다운로드는 필수적인 기능이지만, webOS 환경에서는 다운로드 UI가 제한적이거나 리모컨 조작에 최적화되지 않음
- 대화면 프로젝터 환경에서 다운로드 진행률과 상태를 명확히 표시하여 사용자 경험 향상 필요
- 다운로드 이력 관리 및 재시도 기능을 통해 실사용성 확보

---

## 2. 기능 요구사항 (Functional Requirements)

### FR-1: 다운로드 시작
- **설명**: 웹 페이지에서 파일 링크 클릭 시 다운로드를 자동으로 시작하거나, 사용자가 다운로드 여부를 선택할 수 있는 확인 다이얼로그를 표시합니다.
- **유저 스토리**: As a 사용자, I want 웹 페이지에서 파일 링크를 클릭하면 자동으로 다운로드가 시작되길 원합니다, so that 별도의 복잡한 조작 없이 파일을 받을 수 있습니다.
- **우선순위**: Must
- **세부 요구사항**:
  - webOS WebView에서 다운로드 요청 이벤트 감지
  - 다운로드 확인 다이얼로그 표시 (파일명, 파일 크기, URL)
  - 사용자 확인 후 webOS 다운로드 API 호출하여 다운로드 시작
  - 다운로드 목록에 새 항목 추가 (상태: 진행 중)

### FR-2: 다운로드 진행률 표시
- **설명**: 다운로드 중인 파일의 진행 상태를 실시간으로 표시합니다.
- **유저 스토리**: As a 사용자, I want 다운로드 진행률을 프로그레스바와 퍼센트로 확인하고 싶습니다, so that 다운로드 완료까지 얼마나 남았는지 알 수 있습니다.
- **우선순위**: Must
- **세부 요구사항**:
  - 프로그레스바 (0-100%)
  - 다운로드 속도 표시 (예: 1.2 MB/s)
  - 남은 시간 추정 표시 (예: 약 30초 남음)
  - 다운로드된 크기 / 전체 크기 (예: 5.2 MB / 10.0 MB)
  - 실시간 업데이트 (1초마다 갱신)

### FR-3: 다운로드 일시정지/재개
- **설명**: 진행 중인 다운로드를 일시정지하고 나중에 재개할 수 있습니다.
- **유저 스토리**: As a 사용자, I want 다운로드를 일시정지하고 나중에 다시 시작하고 싶습니다, so that 네트워크 대역폭을 조절하거나 다른 작업을 우선 처리할 수 있습니다.
- **우선순위**: Should
- **세부 요구사항**:
  - 다운로드 항목에서 리모컨으로 "일시정지" 버튼 선택
  - 일시정지된 다운로드는 "재개" 버튼으로 전환
  - webOS 다운로드 API가 일시정지를 지원하지 않을 경우, 다운로드 취소 후 재시작으로 구현
  - 일시정지 상태 표시 (아이콘, 텍스트)

### FR-4: 다운로드 취소/삭제
- **설명**: 진행 중이거나 완료된 다운로드를 취소하거나 목록에서 삭제할 수 있습니다.
- **유저 스토리**: As a 사용자, I want 불필요한 다운로드를 취소하거나 목록에서 삭제하고 싶습니다, so that 다운로드 목록을 깔끔하게 관리할 수 있습니다.
- **우선순위**: Must
- **세부 요구사항**:
  - 진행 중 다운로드: "취소" 버튼으로 다운로드 중단
  - 완료된 다운로드: "삭제" 버튼으로 목록에서 제거 (파일은 유지)
  - 실패한 다운로드: "삭제" 버튼으로 목록에서 제거
  - 삭제 확인 다이얼로그 표시 (실수 방지)

### FR-5: 다운로드 완료 알림
- **설명**: 다운로드가 완료되면 사용자에게 알림을 표시합니다.
- **유저 스토리**: As a 사용자, I want 다운로드가 완료되면 알림을 받고 싶습니다, so that 다른 작업 중에도 다운로드 완료를 놓치지 않을 수 있습니다.
- **우선순위**: Must
- **세부 요구사항**:
  - 화면 상단에 토스트 알림 표시 (3초간 자동 사라짐)
  - 알림 메시지: "다운로드 완료: {파일명}"
  - 알림 클릭 시 다운로드 패널로 이동 (선택 사항)
  - 백그라운드 다운로드 중에도 알림 표시

### FR-6: 다운로드 패널 UI
- **설명**: 다운로드 목록을 확인하고 관리할 수 있는 전용 패널을 제공합니다.
- **유저 스토리**: As a 사용자, I want 다운로드 목록을 한눈에 보고 관리하고 싶습니다, so that 현재 진행 중인 다운로드와 완료된 다운로드를 쉽게 확인할 수 있습니다.
- **우선순위**: Must
- **세부 요구사항**:
  - 메인 UI에 "다운로드" 버튼 추가 (리모컨으로 접근)
  - DownloadPanel 컴포넌트: 다운로드 목록 표시
  - 각 다운로드 항목 표시 정보:
    - 파일명
    - 파일 크기
    - 진행률 (프로그레스바 + 퍼센트)
    - 다운로드 속도 (진행 중일 때만)
    - 남은 시간 (진행 중일 때만)
    - 상태 (진행 중, 일시정지, 완료, 실패)
    - 액션 버튼 (일시정지/재개, 취소/삭제, 열기)
  - 리모컨 방향키로 항목 간 이동, 선택 버튼으로 액션 실행

### FR-7: 다운로드 이력 관리
- **설명**: 완료된 다운로드 이력을 저장하고 조회할 수 있습니다.
- **유저 스토리**: As a 사용자, I want 이전에 다운로드한 파일 목록을 확인하고 싶습니다, so that 나중에 다시 찾거나 재다운로드할 수 있습니다.
- **우선순위**: Should
- **세부 요구사항**:
  - 다운로드 이력 저장 (webOS LocalStorage 또는 IndexedDB)
  - 저장 정보: 파일명, 파일 크기, 다운로드 날짜, 저장 경로, URL
  - 다운로드 패널에서 "완료" 탭과 "진행 중" 탭 분리
  - 이력 목록에서 "재다운로드" 버튼 제공 (동일 URL에서 재시도)
  - 이력 삭제 기능 (목록에서만 제거, 파일은 유지)

### FR-8: 다운로드 재시도
- **설명**: 실패한 다운로드를 재시도할 수 있습니다.
- **유저 스토리**: As a 사용자, I want 네트워크 오류로 실패한 다운로드를 재시도하고 싶습니다, so that 처음부터 다시 다운로드를 시작할 수 있습니다.
- **우선순위**: Must
- **세부 요구사항**:
  - 실패한 다운로드 항목에 "재시도" 버튼 표시
  - 재시도 시 동일 URL에서 다운로드 재시작
  - 실패 사유 표시 (예: 네트워크 오류, 서버 응답 없음)
  - 최대 재시도 횟수 제한 (3회)

### FR-9: 다운로드 파일 열기
- **설명**: 다운로드 완료된 파일을 webOS 기본 앱으로 열 수 있습니다 (선택 사항).
- **유저 스토리**: As a 사용자, I want 다운로드 완료된 파일을 바로 열고 싶습니다, so that 파일 관리자로 이동하지 않고도 파일을 확인할 수 있습니다.
- **우선순위**: Could
- **세부 요구사항**:
  - 완료된 다운로드 항목에 "열기" 버튼 표시
  - webOS 기본 앱 호출 (이미지 뷰어, PDF 뷰어 등)
  - webOS에서 지원하지 않는 파일 형식은 "열기" 버튼 비활성화

### FR-10: 백그라운드 다운로드
- **설명**: 다운로드 패널을 닫아도 백그라운드에서 다운로드가 계속 진행됩니다.
- **유저 스토리**: As a 사용자, I want 다운로드 패널을 닫고 다른 웹 페이지를 탐색해도 다운로드가 계속되길 원합니다, so that 다운로드를 기다리는 동안 다른 작업을 할 수 있습니다.
- **우선순위**: Must
- **세부 요구사항**:
  - 다운로드는 DownloadManager 서비스에서 관리 (컴포넌트 언마운트와 독립)
  - 다운로드 패널 닫아도 다운로드 계속 진행
  - 다운로드 진행 중임을 나타내는 글로벌 인디케이터 표시 (예: 상단 바에 작은 아이콘)

---

## 3. 비기능 요구사항 (Non-Functional Requirements)

### 성능
- **다운로드 속도**: webOS 네트워크 스택 성능에 따라 최대 속도 지원 (일반적으로 5-10 MB/s)
- **UI 반응 속도**: 다운로드 진행률 업데이트 주기 1초, UI 버튼 클릭 후 0.3초 이내 반응
- **메모리 사용량**: 동시 다운로드 5개까지 지원, 다운로드 이력 최대 100개 저장
- **이력 로딩 속도**: 다운로드 패널 열 때 이력 로딩 1초 이내

### UX (리모컨 최적화)
- **포커스 관리**: 리모컨 방향키로 다운로드 항목 간 이동, 선택 버튼으로 액션 실행
- **대화면 가독성**:
  - 최소 폰트 크기 20px (파일명, 상태 텍스트)
  - 프로그레스바 최소 높이 8px
  - 다운로드 항목 간 여백 16px 이상
- **시각적 피드백**:
  - 진행 중 항목에 애니메이션 효과 (프로그레스바 이동)
  - 완료 항목에 체크 아이콘 표시
  - 실패 항목에 경고 아이콘 표시
- **명확한 상태 표시**:
  - 진행 중, 일시정지, 완료, 실패 상태를 아이콘 + 텍스트로 표시
  - 색상 코드: 진행 중(파란색), 완료(녹색), 실패(빨간색), 일시정지(회색)

### 보안
- **HTTPS 우선**: HTTPS URL에서의 다운로드 우선 지원
- **비보안 다운로드 경고**: HTTP URL 다운로드 시 보안 경고 다이얼로그 표시
- **악성 파일 방지**: 실행 파일(.exe, .sh 등) 다운로드 시 경고 메시지 표시 (선택 사항)

### 접근성
- **리모컨 전용 조작**: 모든 다운로드 관리 기능을 리모컨 방향키 + 선택 버튼만으로 수행 가능
- **포커스 순환**: 다운로드 패널 내에서 위/아래 방향키로 항목 간 이동, 좌/우 방향키로 액션 버튼 간 이동
- **스크린 리더 지원**: 다운로드 상태를 aria-label로 제공 (webOS 접근성 API 지원 시)

### 확장성
- **다운로드 엔진 교체 가능**: webOS 다운로드 API 제약이 있을 경우, 대체 방안(XMLHttpRequest, Fetch API)으로 전환 가능하도록 추상화
- **파일 형식 필터링**: 향후 특정 파일 형식만 다운로드 허용/차단 기능 추가 용이
- **다운로드 스케줄링**: 향후 다운로드 예약 기능 추가 가능 (예: 심야 시간대에만 다운로드)

---

## 4. 제약조건

### webOS 플랫폼 제약사항
- **다운로드 API 제한**:
  - webOS가 제공하는 다운로드 API가 제한적일 수 있음 (일시정지/재개 미지원 가능성)
  - 다운로드 파일 저장 경로가 webOS 시스템 정책에 따라 제한될 수 있음 (예: /media/internal/downloads/)
  - webOS 버전에 따라 다운로드 API 동작 차이 가능 (webOS 4.x vs 5.x)
- **리모컨 입력**:
  - 마우스/터치 입력 없음, 리모컨 5-way 방향키 + 선택 버튼만 사용
  - 빠른 입력이 어려우므로 최소한의 조작으로 기능 수행 필요
- **메모리 제약**:
  - 프로젝터 하드웨어 성능 제약으로 동시 다운로드 수 제한 필요 (최대 5개)
  - 대용량 파일 다운로드 시 메모리 부족 위험 (1GB 이상 파일 다운로드 시 경고)

### 웹 브라우저 제약사항
- **CORS 제약**:
  - 일부 웹사이트는 CORS 정책으로 직접 다운로드가 불가능할 수 있음
  - 이 경우 새 탭으로 다운로드 링크를 열어 브라우저 기본 다운로드 사용
- **파일 형식 제한**:
  - webOS에서 지원하지 않는 파일 형식은 다운로드만 가능하고 열기 불가
  - 실행 파일(.exe, .apk 등)은 webOS에서 실행 불가

### 네트워크 제약사항
- **네트워크 불안정**:
  - 가정 내 WiFi 환경에서 네트워크 불안정 시 다운로드 실패 가능
  - 재시도 기능으로 대응
- **대역폭 제한**:
  - 동시에 여러 다운로드 진행 시 대역폭 분산으로 속도 저하 가능

---

## 5. 용어 정의

| 용어 | 정의 |
|------|------|
| **다운로드 패널 (DownloadPanel)** | 다운로드 목록을 표시하고 관리하는 UI 컴포넌트. 메인 브라우저 화면에서 리모컨으로 열 수 있음. |
| **다운로드 매니저 (DownloadManager)** | 다운로드 시작, 진행률 모니터링, 이력 관리 등의 비즈니스 로직을 담당하는 서비스. |
| **진행 중 (In Progress)** | 현재 다운로드가 진행 중인 상태. 프로그레스바와 속도가 실시간으로 업데이트됨. |
| **일시정지 (Paused)** | 사용자가 다운로드를 일시정지한 상태. "재개" 버튼으로 다시 시작 가능. |
| **완료 (Completed)** | 다운로드가 성공적으로 완료된 상태. 파일이 로컬 저장소에 저장됨. |
| **실패 (Failed)** | 네트워크 오류, 서버 응답 없음 등의 이유로 다운로드가 실패한 상태. "재시도" 버튼으로 다시 시도 가능. |
| **백그라운드 다운로드 (Background Download)** | 다운로드 패널을 닫거나 다른 페이지로 이동해도 다운로드가 계속 진행되는 기능. |
| **다운로드 이력 (Download History)** | 과거에 다운로드한 파일 목록. 완료/실패한 다운로드를 조회하고 재다운로드할 수 있음. |
| **webOS 다운로드 API** | webOS 플랫폼에서 제공하는 파일 다운로드 관련 API. LS2 API를 통해 접근. |

---

## 6. 범위 외 (Out of Scope)

### 이번 구현에서 하지 않는 것
- **토렌트 다운로드**: P2P 다운로드는 지원하지 않음 (HTTP/HTTPS 다운로드만)
- **다운로드 스케줄링**: 특정 시간대에 다운로드를 예약하는 기능은 미포함
- **다운로드 대역폭 제한**: 다운로드 속도를 수동으로 제한하는 기능은 미포함
- **다운로드 파일 미리보기**: 다운로드 완료 전에 파일 내용을 미리보기하는 기능은 미포함
- **압축 파일 자동 해제**: .zip, .rar 파일 다운로드 후 자동 압축 해제는 미포함 (webOS 기본 앱에 위임)
- **클라우드 동기화**: 다운로드한 파일을 클라우드 저장소(Google Drive, Dropbox 등)에 자동 업로드하는 기능은 미포함
- **다운로드 카테고리 분류**: 파일 형식별로 자동 폴더 분류(문서, 이미지, 동영상 등)는 미포함

---

## 7. 수용 기준 (Acceptance Criteria)

### 기능 완성도
- [ ] 웹 페이지에서 파일 링크 클릭 시 다운로드 확인 다이얼로그 표시
- [ ] 다운로드 시작 시 DownloadPanel에 항목 추가, 진행률 실시간 업데이트
- [ ] 프로그레스바, 퍼센트, 속도, 남은 시간이 정확히 표시됨
- [ ] 진행 중 다운로드를 일시정지/재개할 수 있음 (webOS API 지원 시)
- [ ] 진행 중 다운로드를 취소할 수 있음
- [ ] 다운로드 완료 시 토스트 알림 표시
- [ ] 완료된 다운로드 목록을 확인할 수 있음
- [ ] 실패한 다운로드를 재시도할 수 있음
- [ ] 다운로드 패널을 닫아도 백그라운드에서 다운로드 계속 진행
- [ ] 다운로드 이력이 LocalStorage에 저장되고, 앱 재시작 후에도 유지됨

### 성능
- [ ] 다운로드 진행률 업데이트 주기 1초 이내
- [ ] 동시 다운로드 5개까지 안정적으로 동작
- [ ] 다운로드 패널 열 때 이력 로딩 1초 이내
- [ ] 10MB 파일 다운로드 시 메모리 누수 없음

### UX
- [ ] 리모컨 방향키로 다운로드 항목 간 이동, 선택 버튼으로 액션 실행 가능
- [ ] 포커스된 항목과 버튼이 명확히 하이라이트됨 (두꺼운 테두리)
- [ ] 진행 중, 완료, 실패 상태가 아이콘 + 색상으로 명확히 구분됨
- [ ] 대화면(3m 거리)에서 파일명, 진행률, 상태 텍스트가 가독 가능 (최소 20px 폰트)

### 보안
- [ ] HTTP URL 다운로드 시 보안 경고 다이얼로그 표시
- [ ] HTTPS URL 다운로드는 경고 없이 진행

### 호환성
- [ ] webOS 4.x 이상에서 정상 동작
- [ ] 주요 파일 형식(PDF, JPG, PNG, MP4, ZIP) 다운로드 테스트 완료
- [ ] 대용량 파일(100MB 이상) 다운로드 시 안정성 확인

### 에러 처리
- [ ] 네트워크 오류 시 "다운로드 실패" 상태 표시, 재시도 버튼 제공
- [ ] 저장 공간 부족 시 에러 메시지 표시
- [ ] webOS 다운로드 API 호출 실패 시 사용자에게 안내 메시지 표시

---

## 8. 기술적 고려사항

### webOS 다운로드 API 조사 필요
- webOS LS2 API 중 파일 다운로드 관련 API 확인 (`com.webos.service.downloadmanager` 등)
- 일시정지/재개 지원 여부 확인
- 다운로드 파일 저장 경로 제약 확인
- 대체 방안: webOS API 제약이 클 경우, XMLHttpRequest 또는 Fetch API로 직접 다운로드 구현 고려

### 상태 관리 전략
- DownloadManager 서비스에서 다운로드 상태를 전역 관리
- React Context API로 다운로드 상태를 컴포넌트 간 공유
- IndexedDB 또는 LocalStorage에 다운로드 이력 영속 저장

### UI/UX 설계
- DownloadPanel은 Panel 컴포넌트로 구현 (Moonstone Panel)
- 다운로드 항목은 리스트 형태로 표시 (Spotlightable List)
- 프로그레스바는 Moonstone ProgressBar 컴포넌트 사용

---

## 변경 이력

| 날짜 | 변경 내용 | 작성자 |
|------|----------|--------|
| 2026-02-13 | 초안 작성 | product-manager |
